# File Directory Map

This document describes the expected on-disk layout for the AltProductionHosting service when deployed under `/var/www/`. It serves as a single reference for where source code, build artifacts, configuration, and operational assets are stored on the server.

## Top-Level Layout

```
/var/www/
└── alt-production-hosting/
    ├── README.md
    ├── FileDirectoryMap.md
    ├── backend/
    ├── frontend/
    ├── docs/
    ├── infrastructure/
    ├── scripts/
    ├── shared/
    └── tmp/
```

* `README.md` – deployment landing page with links to operational docs.
* `FileDirectoryMap.md` – this document; keep it alongside the codebase for quick reference.
* `shared/` – optional space for assets shared between backend and frontend (uploaded images, compiled assets). Created during provisioning.
* `tmp/` – writable scratch directory for temporary artifacts created by the application (build caches, socket files). Can be purged during deployments.

> **Naming convention:** The project root directory under `/var/www/` is `alt-production-hosting/` (all lowercase with hyphens). Adjust automation scripts to match this name.

## Backend Service (`/var/www/alt-production-hosting/backend`)

```
backend/
├── package.json
├── package-lock.json
├── tsconfig.json
├── node_modules/
├── dist/                # Generated during build pipeline
├── src/
│   ├── config/
│   ├── modules/
│   │   ├── auth/
│   │   ├── domains/
│   │   ├── editor/
│   │   ├── hosting/
│   │   └── users/
│   ├── routes/
│   └── server/
├── tests/
├── scripts/
└── logs/
```

Directory notes:

* `src/` – TypeScript source organized by domain. Subdirectories mirror the repository.
  * `config/` – environment-specific configuration files (e.g., `default.ts`, `production.ts`). Symlink or copy deployment-specific overrides here.
  * `modules/` – feature modules split into domain-driven folders.
  * `routes/` – HTTP route definitions.
  * `server/` – server bootstrap and middleware wiring.
* `dist/` – compiled JavaScript output. Populate during CI/CD; exclude from version control but retain on server for runtime.
* `node_modules/` – installed dependencies. Managed via `npm ci` during deployment.
* `tests/` – (create if absent) colocated backend integration/unit tests.
* `scripts/` – utility executables for backend operations (database migrations, seeding). Mirrors repository `backend/scripts` if present.
* `logs/` – runtime log files collected by process manager (e.g., PM2, systemd). Ensure writable permissions for the service user.

### Backend Runtime Support

* Systemd unit files live in `/etc/systemd/system/alt-production-hosting-backend.service` (outside `/var/www/` but relevant). They should reference the `backend/` directory.
* Environment variables are supplied via `/var/www/alt-production-hosting/backend/.env` (not committed to git). Maintain a `.env.example` alongside the repo copy.

## Frontend Application (`/var/www/alt-production-hosting/frontend`)

```
frontend/
├── package.json
├── package-lock.json
├── tsconfig.json
├── tsconfig.node.json
├── vite.config.ts
├── node_modules/
├── src/
│   ├── components/
│   ├── pages/
│   ├── routes/
│   ├── services/
│   ├── styles/
│   └── types/
├── public/
├── dist/                  # Production build output (Vite)
└── tests/
```

Directory notes:

* `src/` – source tree with React components, page-level views, client services, routing, styles, and shared TypeScript types.
* `public/` – static assets copied into the build (favicons, robots.txt). Create if not already present.
* `dist/` – production build artifacts generated by `npm run build`. Served by the chosen web server (e.g., Nginx) from `/var/www/alt-production-hosting/frontend/dist/`.
* `tests/` – optional directory for unit/UI tests (Vitest, Playwright).

### Frontend Hosting Support

* If using Nginx or another reverse proxy, point the document root to `/var/www/alt-production-hosting/frontend/dist/`.
* Environment-specific configuration can be stored in `/var/www/alt-production-hosting/frontend/.env.production` (ignored by git).

## Documentation (`/var/www/alt-production-hosting/docs`)

```
docs/
├── architecture.md
├── backend-module-guide.md
├── frontend-overview.md
├── operational-playbook.md
├── storage-and-deployment.md
├── ubuntu25-deployment.md
└── images/
```

* Markdown documentation for architecture, deployment, and operations lives here.
* `images/` – diagrams or screenshots referenced by documentation. Maintain relative links within docs.
* Additional guides should follow the `kebab-case.md` naming convention and reside alongside existing files.

## Infrastructure Definitions (`/var/www/alt-production-hosting/infrastructure`)

```
infrastructure/
├── database/
│   └── migrations/        # SQL files or ORM migration scripts
└── terraform/
    ├── main.tf
    ├── variables.tf
    ├── outputs.tf
    └── modules/
```

* `database/` – schema migrations, seed data, and database initialization scripts. Organize by date-based filenames.
* `terraform/` – infrastructure-as-code configuration. If modules are used, nest them under `modules/`.
* Keep generated state (`terraform.tfstate`) outside the repository (e.g., remote backend) or in a protected location.

## Operational Scripts (`/var/www/alt-production-hosting/scripts`)

```
scripts/
├── README.md
├── check-services.sh
└── install-ubuntu25.sh
```

* Shell scripts for provisioning, health checks, and maintenance live here.
* Ensure each script is executable (`chmod +x`).
* Additional automation scripts should follow the naming convention `verb-target.sh` (e.g., `deploy-backend.sh`).

## Shared Assets (`/var/www/alt-production-hosting/shared`)

* `uploads/` – user-generated files (images, documents). Back up regularly.
* `config/` – configuration templates or JSON payloads shared between services.
* Subdirectories can be added as the project grows; document them in this file when created.

## Temporary Working Directory (`/var/www/alt-production-hosting/tmp`)

* `build-cache/` – caches for faster builds (npm, Vite).
* `sockets/` – Unix domain sockets if the backend uses them.
* `sessions/` – session files for fallback session stores.
* Contents are ephemeral and can be cleared during deployments.

## Backups and Versioning

* Use git to track the source directories (`backend`, `frontend`, `docs`, `infrastructure`, `scripts`).
* Exclude runtime directories (`dist`, `node_modules`, `logs`, `tmp`, `shared/uploads`) via `.gitignore`.
* Store this document in source control so updates to the layout are reviewable.

## Ownership and Permissions

* Service user: `altprod` (example). Grant ownership of `/var/www/alt-production-hosting/` to this user.
* Group: `www-data` or application-specific group to facilitate web server access.
* Sensitive files (environment variables, private keys) should have `600` permissions and be owned by `altprod`.

## Deployment Checklist

1. Create `/var/www/alt-production-hosting/` and subdirectories as listed above.
2. Clone or sync the repository into this location.
3. Run `npm ci && npm run build` in both `backend/` and `frontend/`.
4. Configure process manager/web server to point at backend entry point and frontend `dist/` output.
5. Update this map if the project structure changes.

